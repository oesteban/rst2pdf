dependencies:
  pre:
    - mkdir -p ${CIRCLE_TEST_REPORTS}/nose ~/pdf/
    - pip install -r requirements.txt
  override:
    - pip install -e .[tests,sphinx,hyphenation,images,pdfimages,pdfimages2,svgsupport,aafiguresupport,rawhtmlsupport]
    - python bootstrap.py
    - ./bin/buildout
test:
  override:
    - nosetests -i regulartest -i sphinxtest --with-xunit --xunit-file=${CIRCLE_TEST_REPORTS}/nose/${CIRCLE_PROJECT_REPONAME}.xml
  post:
#    - ./rst2pdf/tests/parselogs.py > ~/log.txt
    - cat ./rst2pdf/tests/output/*.log >> ~/log.txt
    - mv ./rst2pdf/tests/output/*.pdf ~/pdf/
general:
  artifacts:
    - "~/pdf/"
    - "~/log.txt"
    - "~/rst2pdf/rst2pdf/tests/output/"
